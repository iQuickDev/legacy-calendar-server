// https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

enum InviteStatus {
  PENDING
  ACCEPTED
  DECLINED
}

model User {
  id             Int     @id @default(autoincrement())
  username       String  @unique
  password       String
  profilePicture String?

  fcmTokens FcmToken[]

  hostedEvents Event[] @relation("EventHost")

  invitations Attendance[]
}

model FcmToken {
  id        Int      @id @default(autoincrement())
  token     String   @unique
  userId    Int
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  createdAt DateTime @default(now())
}

model Event {
  id          Int      @id @default(autoincrement())
  title       String
  description String?
  location    String?
  startTime   DateTime
  endTime     DateTime

  // Event Features
  hasFood    Boolean @default(false)
  hasWeed    Boolean @default(false)
  hasSleep   Boolean @default(false)
  hasAlcohol Boolean @default(false)

  hostId Int
  host   User    @relation("EventHost", fields: [hostId], references: [id])
  isOpen Boolean @default(true)

  participants Attendance[]
}

model Attendance {
  id      Int          @id @default(autoincrement())
  userId  Int
  eventId Int
  status  InviteStatus @default(PENDING)

  // Participant Features
  wantsFood    Boolean @default(false)
  wantsWeed    Boolean @default(false)
  wantsSleep   Boolean @default(false)
  wantsAlcohol Boolean @default(false)

  user  User  @relation(fields: [userId], references: [id])
  event Event @relation(fields: [eventId], references: [id], onDelete: Cascade)

  @@unique([userId, eventId])
}
